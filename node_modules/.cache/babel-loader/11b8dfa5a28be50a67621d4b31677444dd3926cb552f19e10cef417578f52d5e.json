{"ast":null,"code":"'use strict';\n\nimport { defineAnimation, getReduceMotionForAnimation } from \"../util.js\";\nimport { rubberBandDecay } from \"./rubberBandDecay.js\";\nimport { isValidRubberBandConfig } from \"./utils.js\";\nimport { rigidDecay } from \"./rigidDecay.js\";\nimport { ReanimatedError } from \"../../errors.js\";\n\n// TODO TYPESCRIPT This is a temporary type to get rid of .d.ts file.\n\nfunction validateConfig(config) {\n  'worklet';\n\n  if (config.clamp) {\n    if (!Array.isArray(config.clamp)) {\n      throw new ReanimatedError(\"`config.clamp` must be an array but is \".concat(typeof config.clamp, \".\"));\n    }\n    if (config.clamp.length !== 2) {\n      throw new ReanimatedError(\"`clamp array` must contain 2 items but is given \".concat(config.clamp.length, \".\"));\n    }\n  }\n  if (config.velocityFactor <= 0) {\n    throw new ReanimatedError(\"`config.velocityFactor` must be greater then 0 but is \".concat(config.velocityFactor, \".\"));\n  }\n  if (config.rubberBandEffect && !config.clamp) {\n    throw new ReanimatedError('You need to set `clamp` property when using `rubberBandEffect`.');\n  }\n}\n\n/**\n * Lets you create animations that mimic objects in motion with friction.\n *\n * @param config - The decay animation configuration - {@link DecayConfig}.\n * @param callback - A function called upon animation completion -\n *   {@link AnimationCallback}.\n * @returns An [animation\n *   object](https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/glossary#animation-object)\n *   which holds the current state of the animation.\n * @see https://docs.swmansion.com/react-native-reanimated/docs/animations/withDecay\n */\nexport const withDecay = function (userConfig, callback) {\n  'worklet';\n\n  return defineAnimation(0, () => {\n    'worklet';\n\n    var _config$velocity;\n    const config = {\n      deceleration: 0.998,\n      velocityFactor: 1,\n      velocity: 0,\n      rubberBandFactor: 0.6\n    };\n    if (userConfig) {\n      Object.keys(userConfig).forEach(key => config[key] = userConfig[key]);\n    }\n    const decay = isValidRubberBandConfig(config) ? (animation, now) => rubberBandDecay(animation, now, config) : (animation, now) => rigidDecay(animation, now, config);\n    function onStart(animation, value, now) {\n      animation.current = value;\n      animation.lastTimestamp = now;\n      animation.startTimestamp = now;\n      animation.initialVelocity = config.velocity;\n      validateConfig(config);\n      if (animation.reduceMotion && config.clamp) {\n        if (value < config.clamp[0]) {\n          animation.current = config.clamp[0];\n        } else if (value > config.clamp[1]) {\n          animation.current = config.clamp[1];\n        }\n      }\n    }\n    return {\n      onFrame: decay,\n      onStart,\n      callback,\n      velocity: (_config$velocity = config.velocity) !== null && _config$velocity !== void 0 ? _config$velocity : 0,\n      initialVelocity: 0,\n      current: 0,\n      lastTimestamp: 0,\n      startTimestamp: 0,\n      reduceMotion: getReduceMotionForAnimation(config.reduceMotion)\n    };\n  });\n};","map":{"version":3,"names":["defineAnimation","getReduceMotionForAnimation","rubberBandDecay","isValidRubberBandConfig","rigidDecay","ReanimatedError","validateConfig","config","clamp","Array","isArray","concat","length","velocityFactor","rubberBandEffect","withDecay","userConfig","callback","_config$velocity","deceleration","velocity","rubberBandFactor","Object","keys","forEach","key","decay","animation","now","onStart","value","current","lastTimestamp","startTimestamp","initialVelocity","reduceMotion","onFrame"],"sources":["/Users/carter/WebstormProjects/personal-website/node_modules/react-native-reanimated/src/animation/decay/decay.ts"],"sourcesContent":["'use strict';\nimport { defineAnimation, getReduceMotionForAnimation } from '../util';\nimport type {\n  AnimationCallback,\n  Timestamp,\n  Animation,\n} from '../../commonTypes';\nimport { rubberBandDecay } from './rubberBandDecay';\nimport { isValidRubberBandConfig } from './utils';\nimport type {\n  DecayAnimation,\n  DecayConfig,\n  DefaultDecayConfig,\n  InnerDecayAnimation,\n} from './utils';\nimport { rigidDecay } from './rigidDecay';\nimport { ReanimatedError } from '../../errors';\n\nexport type WithDecayConfig = DecayConfig;\n\n// TODO TYPESCRIPT This is a temporary type to get rid of .d.ts file.\ntype withDecayType = (\n  userConfig: DecayConfig,\n  callback?: AnimationCallback\n) => number;\n\nfunction validateConfig(config: DefaultDecayConfig): void {\n  'worklet';\n  if (config.clamp) {\n    if (!Array.isArray(config.clamp)) {\n      throw new ReanimatedError(\n        `\\`config.clamp\\` must be an array but is ${typeof config.clamp}.`\n      );\n    }\n    if (config.clamp.length !== 2) {\n      throw new ReanimatedError(\n        `\\`clamp array\\` must contain 2 items but is given ${\n          config.clamp.length as number\n        }.`\n      );\n    }\n  }\n  if (config.velocityFactor <= 0) {\n    throw new ReanimatedError(\n      `\\`config.velocityFactor\\` must be greater then 0 but is ${config.velocityFactor}.`\n    );\n  }\n  if (config.rubberBandEffect && !config.clamp) {\n    throw new ReanimatedError(\n      'You need to set `clamp` property when using `rubberBandEffect`.'\n    );\n  }\n}\n\n/**\n * Lets you create animations that mimic objects in motion with friction.\n *\n * @param config - The decay animation configuration - {@link DecayConfig}.\n * @param callback - A function called upon animation completion -\n *   {@link AnimationCallback}.\n * @returns An [animation\n *   object](https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/glossary#animation-object)\n *   which holds the current state of the animation.\n * @see https://docs.swmansion.com/react-native-reanimated/docs/animations/withDecay\n */\nexport const withDecay = function (\n  userConfig: DecayConfig,\n  callback?: AnimationCallback\n): Animation<DecayAnimation> {\n  'worklet';\n\n  return defineAnimation<DecayAnimation>(0, () => {\n    'worklet';\n    const config: DefaultDecayConfig = {\n      deceleration: 0.998,\n      velocityFactor: 1,\n      velocity: 0,\n      rubberBandFactor: 0.6,\n    };\n    if (userConfig) {\n      Object.keys(userConfig).forEach(\n        (key) =>\n          ((config as any)[key] = userConfig[key as keyof typeof userConfig])\n      );\n    }\n\n    const decay: (animation: InnerDecayAnimation, now: number) => boolean =\n      isValidRubberBandConfig(config)\n        ? (animation, now) => rubberBandDecay(animation, now, config)\n        : (animation, now) => rigidDecay(animation, now, config);\n\n    function onStart(\n      animation: DecayAnimation,\n      value: number,\n      now: Timestamp\n    ): void {\n      animation.current = value;\n      animation.lastTimestamp = now;\n      animation.startTimestamp = now;\n      animation.initialVelocity = config.velocity;\n      validateConfig(config);\n\n      if (animation.reduceMotion && config.clamp) {\n        if (value < config.clamp[0]) {\n          animation.current = config.clamp[0];\n        } else if (value > config.clamp[1]) {\n          animation.current = config.clamp[1];\n        }\n      }\n    }\n\n    return {\n      onFrame: decay,\n      onStart,\n      callback,\n      velocity: config.velocity ?? 0,\n      initialVelocity: 0,\n      current: 0,\n      lastTimestamp: 0,\n      startTimestamp: 0,\n      reduceMotion: getReduceMotionForAnimation(config.reduceMotion),\n    } as DecayAnimation;\n  });\n} as unknown as withDecayType;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}